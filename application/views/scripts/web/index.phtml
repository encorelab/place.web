<?php
//print_r($_SESSION);
?>
<!DOCTYPE html>
<!--<?php 
echo $this->doctype() ?>-->
<!-- To be HTML5 we do this -->
  <!--<html xmlns="http://www.w3.org/1999/xhtml">-->
<html>
<head>
  <!-- To be HTML5 we do this -->
  <!-- <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> -->
  <meta charset="utf-8" />

  <title>PLACE.web</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    
    <script type="text/javascript" src="/jquery/jqueryfileupload/jquery.iframe-transport.js"></script>
    <script type="text/javascript" src="/jquery/jqueryfileupload/jquery.fileupload.js"></script>
    <script type="text/javascript" src="/jquery/jqueryfileupload/jquery.fileupload-ui.js"></script>
    
    <script type="text/javascript" src="/jquery/jplayer/jquery.jplayer.min.js"></script>
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
    
    <link type="text/css" rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css" />
    <link type="text/css" rel="stylesheet" href="/jquery/jqueryfileupload/jquery.fileupload-ui.css" />
    <link type="text/css" rel="stylesheet" href="/jquery/jplayer/themes/blue.monday/jplayer.blue.monday.css" />

	<script src="/js/basic.js" type="text/javascript" ></script>
	<link type="text/css" href="/css/styles.css" rel="stylesheet" />
<?php 
	//echo $this->headLink()->appendStylesheet('/css/global.css') 
?>
<?php 
	//require(APPLICATION_PATH.'/layouts/include/'.'tinymce.head.inc.php');
?>

<script>
$(document).ready(function () {

	  $("#viz-loader").html("");
	  $("#viz-loader").addClass('div-hide');
	  $("#viz-container").removeClass('div-hide');
<?php 
// set viz mode
if($this->vizType==1)
{
	echo "	init();";	
} else if($this->vizType==2) {
	echo "	init1();";	
}
?>
})


</script>
</head>
<body>
<div id="viz-loader"><img src='/images/loader.gif' alt='Loading Icon' /></div>
<div id="viz-container" class="div-hide">
	<!-- CSS Files -->
	<link type="text/css" href="/js/viz/css/base.css" rel="stylesheet" />
	<link type="text/css" href="/js/viz/css/Hypertree.css" rel="stylesheet" />

	<!--[if IE]><script language="javascript" type="text/javascript" src="../../Extras/excanvas.js"></script><![endif]-->

	<!-- JIT Library File -->
	<script language="javascript" type="text/javascript" src="/js/viz/jit.js"></script>
	<script language="javascript" type="text/javascript" src="/js/viz/jit-yc.js"></script>

	<!-- Example File -->
	<script language="javascript" type="text/javascript" src="/web/getd3json?vizEx=<?php echo $this->vizEx?>&vizQu=<?php echo $this->vizQu?>&vizMy=<?php echo $this->vizMy?>&vizCon=<?php echo $this->vizCon?>&conceptId=<?php echo $this->conceptId?>"></script>
	<div id="web-controls">
		<form action="<?php $_SERVER['PHP_SELF']?>" method="get">
		<select name="vizType">
			<option value="1" <?php if($this->vizType==1) {echo ' selected="selected"';} ?>>Viz 1</option>
			<option value="2" <?php if($this->vizType==2) {echo ' selected="selected"';} ?>>Viz 2</option>
		</select>
		<input <?php if($this->vizEx==1) {echo ' checked="checked"';} ?>type="checkbox" name="vizEx" value="1"> Show Examples |
		<input <?php if($this->vizQu==1) {echo ' checked="checked"';} ?>type="checkbox" name="vizQu" value="1"> Show Questions |
		<input <?php if($this->vizMy==1) {echo ' checked="checked"';} ?>type="checkbox" name="vizMy" value="1"> My Contributions |
	<?php 
	//         // get concepts for current run_id
	        $concepts = Doctrine::getTable("Concept")
	                 ->findByDql("run_id = ?", $_SESSION['run_id']);

			$conceptsList = '
			<select name="conceptId">
				<option value="0"> - Show All Concepts</option>		
			';

			foreach ($concepts as $concept)
	        {
	        	$selected="";
	        	if($concept->id==$this->conceptId) {
	        		$selected = ' selected="selected"';
	        	}
	        	$conceptsList .= '
	        	<option value="'.$concept->id.'"'.$selected.'>'.$concept->name.'</option>';
	        }
	        $conceptsList .= '
	        </select>';

	        echo $conceptsList;

	?>

	<!-- 
		<input <?php if($this->vizCon==1) {echo ' checked="checked"';} ?>type="checkbox" name="vizCon" value="1"> Show only used Concepts|
	 -->
		<input type="submit" value="Refresh" />
		</form>
	</div>
	<div id="web-container">
		<!-- 
		<div id="left-container">
		        <div class="text">
		            This visualization shows the relationships between ELOs.<br /><br />
		            Clicking on a node should move the tree and center that node.<br /><br />
		            The centered node's children are displayed in a relations list in the right column.
		        </div>
		</div>
		 -->
		<div id="id-list"></div>
		<div id="center-container">
		<div id="infovis"></div>
		</div>

		<div id="right-container">
		<div id="inner-details"></div>
		</div>
	</div>
	<div id="log"></div>
</div>

</body>
</html>
